Code from blogpost at https://baoilleach.blogspot.com/2025/01/release-of-partialsmiles-v20-validating.html
